import torch

a = torch.rand(4,1,28,28)
# torch.Size([4, 1, 28, 28])
print(a.shape)
# torch.Size([1, 4, 1, 28, 28])
print(a.unsqueeze(0).shape)
# torch.Size([4, 1, 28, 28, 1])
print(a.unsqueeze(-1).shape)
# torch.Size([4, 1, 28, 28, 1])
print(a.unsqueeze(4).shape)
# torch.Size([4, 1, 1, 28, 28])
print(a.unsqueeze(-4).shape)
# torch.Size([1, 4, 1, 28, 28])
print(a.unsqueeze(-5).shape)
# torch.Size([4, 1, 28, 28, 1])
print(a.unsqueeze(4).shape)
# IndexError: Dimension out of range (expected to be in range of [-5, 4], but got -6)
# print(a.unsqueeze(-6).shape)
# IndexError: Dimension out of range (expected to be in range of [-5, 4], but got 5)
# print(a.unsqueeze(5).shape)

a = torch.tensor([1.2, 2.3])
# torch.Size([2])
print(a.shape)
# tensor([[1.2000],
#         [2.3000]])
print(a.unsqueeze(-1))
# tensor([[1.2000, 2.3000]])
print(a.unsqueeze(0))
# torch.Size([2, 1])
print(a.unsqueeze(-1).shape)
# torch.Size([1, 2])
print(a.unsqueeze(0).shape)

b = torch.rand(32)
f = torch.rand(4, 32, 14, 14)
b = b.unsqueeze(1).unsqueeze(2).unsqueeze(0)
# torch.Size([1, 32, 1, 1])
print(b.shape)